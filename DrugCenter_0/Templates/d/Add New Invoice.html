
{% extends "Drug/Daroo/base.html" %}


{% block content %}
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <title>Add New Invoice</title>
                <!-- Favicon and touch icons -->
        <link rel="shortcut icon" href="../../static/Add%20New%20Invoice_files/13ce2ba4f439628320674dc0fad86f64.png" type="image/x-icon">
        <link rel="apple-touch-icon" type="image/x-icon" href="http://pharmacyv5.bdtask.com/version8.1/assets/dist/img/ico/apple-touch-icon-57-precomposed.png">
        <link rel="apple-touch-icon" type="image/x-icon" sizes="72x72" href="http://pharmacyv5.bdtask.com/version8.1/assets/dist/img/ico/apple-touch-icon-72-precomposed.png">
        <link rel="apple-touch-icon" type="image/x-icon" sizes="114x114" href="http://pharmacyv5.bdtask.com/version8.1/assets/dist/img/ico/apple-touch-icon-114-precomposed.png">
        <link rel="apple-touch-icon" type="image/x-icon" sizes="144x144" href="http://pharmacyv5.bdtask.com/version8.1/assets/dist/img/ico/apple-touch-icon-144-precomposed.png">
        <!-- Start Global Mandatory Style-->
        <!-- start icheck css -->

        <!-- jquery-ui css -->
        <link href="../../static/Add%20New%20Invoice_files/jquery-ui.css" rel="stylesheet" type="text/css">
        <!-- Bootstrap -->
        <link href="../../static/Add%20New%20Invoice_files/bootstrap.css" rel="stylesheet" type="text/css">
        <!-- modals css -->
        <link href="../../static/Add%20New%20Invoice_files/cmxform.css" rel="stylesheet" type="text/css">
        <link href="../../static/Add%20New%20Invoice_files/component.css" rel="stylesheet" type="text/css">
                <!-- Font Awesome -->
        <link href="../../static/Add%20New%20Invoice_files/font-awesome.css" rel="stylesheet" type="text/css">
        <!-- Themify icons -->
        <link href="../../static/Add%20New%20Invoice_files/themify-icons.css" rel="stylesheet" type="text/css">
        <!-- Pe-icon -->
        <link href="../../static/Add%20New%20Invoice_files/pe-icon-7-stroke.css" rel="stylesheet" type="text/css">
        <!-- Data Tables -->
        <link href="../../static/Add%20New%20Invoice_files/dataTables.css" rel="stylesheet" type="text/css">
        <!-- Theme style -->
        <link href="../../static/Add%20New%20Invoice_files/styleBD.css" rel="stylesheet" type="text/css">

        <!-- Select 2 css -->
        <link href="../../static/Add%20New%20Invoice_files/select2.css" rel="stylesheet" type="text/css">

                <!-- jQuery -->
        <script src="../../static/Add%20New%20Invoice_files/jquery-1.js" type="text/javascript"></script>
        <script src="../../static/Add%20New%20Invoice_files/jquery_003.js" type="text/javascript"></script>
    <style type="text/css">.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}</style></head>
<body class="sidebar-mini fixed">
        <div class="se-pre-con" style="display: none;"></div>

        <!-- Site wrapper -->
        <div class="wrapper">
            <!-- Admin header end -->
<style type="text/css">
   .navbar .btn-success{
        margin: 13px 2px;
   }
</style>
<script src="../../static/Add%20New%20Invoice_files/customer.php"></script>
<!-- Product invoice js -->
<script src="../../static/Add%20New%20Invoice_files/product_invoice.php"></script>
<!-- Invoice js -->
<script src="../../static/Add%20New%20Invoice_files/invoice.js" type="text/javascript"></script>
<!-- Add new invoice start -->
<style>
    #bank_info_hide
    {
        display:none;
    }
    #payment_from_2
    {
        display:none;
    }
</style>

<!-- Customer type change by javascript start -->
<script type="text/javascript">
    function bank_info_show(payment_type)
    {
        if(payment_type.value=="1"){
            document.getElementById("bank_info_hide").style.display="none";
        }
        else{
            document.getElementById("bank_info_hide").style.display="block";
        }
    }

    function active_customer(status)
    {
        if(status=="payment_from_2"){
            document.getElementById("payment_from_2").style.display="none";
            document.getElementById("payment_from_1").style.display="block";
            document.getElementById("myRadioButton_2").checked = false;
            document.getElementById("myRadioButton_1").checked = true;
        }
        else{
            document.getElementById("payment_from_1").style.display="none";
            document.getElementById("payment_from_2").style.display="block";
            document.getElementById("myRadioButton_2").checked = false;
            document.getElementById("myRadioButton_1").checked = true;
        }
    }
</script>
<!-- Customer type change by javascript end -->

 <section class="content">
                <div class="row">
            <div class="col-sm-12">
                <div class="column">

                                             <a href="http://pharmacyv5.bdtask.com/version8.1/Cinvoice/manage_invoice" class="btn btn-info m-b-5 m-r-2"><i class="ti-align-justify"> </i> Manage Invoice  </a>

                                            <a href="http://pharmacyv5.bdtask.com/version8.1/Cinvoice/pos_invoice" class="btn btn-primary m-b-5 m-r-2"><i class="ti-align-justify"> </i>  POS Invoice </a>

                </div>
            </div>
        </div>

                <!--Add Invoice -->
        <div class="row">
            <div class="col-sm-12">
                <div class="panel panel-bd lobidrag">
                    <div class="panel-heading">
                        <div class="panel-title">
                            <h4>New Invoice</h4>
                        </div>
                    </div>
                    <form action="http://pharmacyv5.bdtask.com/version8.1/Cinvoice/insert_invoice" class="form-vertical" id="" name="" enctype="multipart/form-data" method="post" accept-charset="utf-8">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-sm-8" id="payment_from_1" style="display: block;">
                                <div class="form-group row">
                                    <label for="customer_name" class="col-sm-3 col-form-label">Customer Name <i class="text-danger">*</i></label>
                                    <div class="col-sm-6">
                                        <input type="text" size="100" name="customer_name" class="customerSelection form-control ui-autocomplete-input" placeholder="Customer Name" id="customer_name" tabindex="1" autocomplete="off">

                                        <input id="SchoolHiddenId" class="customer_hidden_value abc" type="hidden" name="customer_id" value="">
                                    </div>
                                    <div class=" col-sm-3">
                                        <input id="myRadioButton_1" type="button" onclick="active_customer('payment_from_1')" class="btn btn-success checkbox_account ac" name="customer_confirm" checked="checked" value="New Customer" tabindex="2">
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-8" id="payment_from_2" style="display: none;">
                               <div class="form-group row">
                                    <label for="customer_name_others" class="col-sm-3 col-form-label">Payee Name <i class="text-danger">*</i></label>
                                    <div class="col-sm-6">
                                        <input autofill="off" type="text" size="100" name="customer_name_others" placeholder="Payee Name" id="customer_name_others" class="form-control">
                                    </div>

                                    <div class="col-sm-3">
                                        <input onclick="active_customer('payment_from_2')" type="button" id="myRadioButton_2" class="checkbox_account btn btn-success" name="customer_confirm_others" value="Old Customer">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label for="customer_name_others_address" class="col-sm-3 col-form-label">Address </label>
                                    <div class="col-sm-6">
                                       <input type="text" size="100" name="customer_name_others_address" class=" form-control" placeholder="Address" id="customer_name_others_address">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group row">
                                    <label for="date" class="col-sm-4 col-form-label">Date <i class="text-danger">*</i></label>
                                    <div class="col-sm-8">
                                                                               <input class="datepicker form-control hasDatepicker" type="text" size="50" name="invoice_date" id="date" required="" value="2019-04-09" tabindex="6">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="table-responsive" style="margin-top: 10px">
                            <table class="table table-bordered table-hover" id="normalinvoice">
                                <thead>
                                    <tr>
                                        <th class="text-center" style="width: 220px">Item Information <i class="text-danger">*</i></th>
                                        <th class="text-center" width="130">Batch<i class="text-danger">*</i></th>
                                        <th class="text-center">Ava.Qty</th>
                                        <th class="text-center" width="120">Expiry</th>
                                        <th class="text-center">Unit</th>
                                        <th class="text-center">Qty <i class="text-danger">*</i></th>
                                        <th class="text-center">Price <i class="text-danger">*</i></th>

                                                                                <th class="text-center">Discount / Pcs. </th>

                                        <th class="text-center">Total                                        </th>
                                        <th class="text-center">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="addinvoiceItem">
                                    <tr>
                                        <td style="width: 220px">
                                            <input type="text" name="product_name" onkeyup="invoice_productList(1);" class="form-control productSelection" placeholder="Medicine Name" required="" id="product_name" tabindex="7">

                                            <input type="hidden" class="autocomplete_hidden_value product_id_1" name="product_id[]" id="SchoolHiddenId">

                                            <input type="hidden" class="baseUrl" value="http://pharmacyv5.bdtask.com/version8.1/">
                                        </td>
                                        <td>
                                            <select class="form-control select2-hidden-accessible" id="batch_id_1" name="batch_id[]" required="required" onchange="product_stock(1)" tabindex="-1" aria-hidden="true">
                                                <option selected="selected"></option>
                                            </select><span class="select2 select2-container select2-container--default" dir="ltr" style="width: 113px;"><span class="selection"><span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="8" aria-labelledby="select2-batch_id_1-container"><span class="select2-selection__rendered" id="select2-batch_id_1-container"><span class="select2-selection__placeholder">Select option</span></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
                                        </td>
                                        <td>
                                            <input type="text" name="available_quantity[]" class="form-control text-right available_quantity_1" value="0" readonly="readonly" id="available_quantity_1">
                                        </td>
                                        <td id="expire_date_1">

                                        </td>
                                        <td>
                                            <input name="" id="" class="form-control text-right unit_1 valid" value="None" readonly="readonly" aria-invalid="false" type="text">
                                        </td>
                                        <td>
                                            <input type="text" name="product_quantity[]" onkeyup="quantity_calculate(1),checkqty(1);" onchange="quantity_calculate(1);" class="total_qntt_1 form-control text-right" id="total_qntt_1" placeholder="0.00" min="0" tabindex="9">
                                        </td>
                                        <td>
                                            <input type="text" name="product_rate[]" id="price_item_1" class="price_item1 price_item form-control text-right" tabindex="10" required="" onkeyup="quantity_calculate(1),checkqty(1);" onchange="quantity_calculate(1);" placeholder="0.00" min="0" readonly="readonly">
                                        </td>
                                        <!-- Discount -->
                                        <td>
                                            <input type="text" name="discount[]" onkeyup="quantity_calculate(1),checkqty(1);" onchange="quantity_calculate(1);" id="discount_1" class="form-control text-right" min="0" tabindex="11" placeholder="0.00">

                                            <input type="hidden" value="" name="discount_type" id="discount_type_1">
                                        </td>


                                        <td style="width: 100px">
                                            <input class="total_price form-control text-right" type="text" name="total_price[]" id="total_price_1" value="0.00" readonly="readonly">
                                        </td>

                                        <td>
                                            <!-- Tax calculate start-->
                                            <input id="total_tax_1" class="total_tax_1" type="hidden">
                                            <input id="all_tax_1" class="total_tax" type="hidden" name="tax[]">
                                            <!-- Tax calculate end-->

                                            <!-- Discount calculate start-->
                                            <input type="hidden" id="total_discount_1" class="">
                                            <input type="hidden" id="all_discount_1" class="total_discount">
                                            <!-- Discount calculate end -->

                                            <button style="text-align: right;" class="btn btn-danger" type="button" value="Delete" onclick="deleteRow(this)" tabindex="11">Delete
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>

                                <tfoot>
                                    <tr>
                                         <td align="center">
                                            <input type="button" id="add_invoice_item" class="btn btn-info" name="add-invoice-item" onclick="addInputField('addinvoiceItem');" value="Add New Item" tabindex="32">

                                            <input type="hidden" name="baseUrl" class="baseUrl" value="http://pharmacyv5.bdtask.com/version8.1/">
                                        </td>
                                        <td style="text-align:right;" colspan="7"><b>Total Tax:</b></td>
                                        <td class="text-right">
                                            <input id="total_tax_ammount" tabindex="-1" class="form-control text-right valid" name="total_tax" value="0.00" readonly="readonly" aria-invalid="false" type="text">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="7" rowspan="2">
                                        <center><label style="text-align:center;" for="details" class="  col-form-label">Invoice Details</label></center>
                                        <textarea name="inva_details" class="form-control" placeholder="Invoice Details"></textarea>
                                    </td>
                                        <td style="text-align:right;" colspan="1"><b>Total Discount:</b></td>
                                        <td class="text-right">
                                            <input type="text" id="total_discount_ammount" class="form-control text-right" name="total_discount" value="0.00" readonly="readonly">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="1" style="text-align:right;"><b>Sub Total:</b></td>
                                        <td class="text-right">
                                            <input type="text" id="grandTotal" class="form-control text-right" name="grand_total_price" value="0.00" readonly="readonly">
                                        </td>
                                    </tr>
                                     <tr>
                                        <td colspan="8" style="text-align:right;"><b>Invoice Discount:</b></td>
                                        <td class="text-right">
                                            <input type="text" id="invdcount" class="form-control text-right" name="invdcount" onkeyup="invoice_discount(),checknum();" placeholder="0.00" tabindex="33">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="8" style="text-align:right;"><b>Grand Total:</b></td>
                                        <td class="text-right">
                                            <input type="text" id="invtotal" class="form-control text-right" name="invtotal" value="0.00" readonly="readonly">
                                        </td>
                                    </tr>
                                    <tr>

                                        <td style="text-align:right;" colspan="8"><b>Paid Amount:</b></td>
                                        <td class="text-right">
                                            <input type="text" id="paidAmount" onkeyup="invoice_paidamount(),checknum();" class="form-control text-right" name="paid_amount" placeholder="0.00" tabindex="34">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="center">
                                            <input type="button" id="full_paid_tab" class="btn btn-warning" value="Full Paid" tabindex="35" onclick="full_paid()">

                                            <input type="submit" id="add_invoice" class="btn btn-success" name="add-invoice" value="Submit" tabindex="36">
                                        </td>

                                        <td style="text-align:right;" colspan="7"><b>Due:</b></td>
                                        <td class="text-right">
                                            <input type="text" id="dueAmmount" class="form-control text-right" name="due_amount" value="0" readonly="readonly">
                                        </td>
                                    </tr>
                                    <tr id="change_m"><td style="text-align:right;" colspan="8" id="ch_l"><b>Change:</b></td>
                                        <td class="text-right">
                                            <input type="text" id="change" class="form-control text-right" name="change" value="0.00" readonly="readonly">
                                        </td></tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                    </form>                </div>
            </div>
        </div>


    </section>

<div class="content-wrapper" style="min-height: 720px;">
    <section class="content-header">
        <div class="header-icon">
            <i class="pe-7s-note2"></i>
        </div>
        <div class="header-title">
            <h1>New Invoice</h1>
            <small>Add New Invoice</small>
            <ol class="breadcrumb">
                <li><a href="#"><i class="pe-7s-home"></i> Home</a></li>
                <li><a href="#">Invoice</a></li>
                <li class="active">New Invoice</li>
            </ol>
        </div>
    </section>

</div>
<!-- Invoice Report End -->

<script type="text/javascript">
    $('.ac').click(function () {
     $('.customer_hidden_value').val('');
 });
$('#myRadioButton_1').click(function () {
     $('#customer_name').val('');
 });

$('#myRadioButton_2').click(function () {
     $('#customer_name_others').val('');
 });
$('#myRadioButton_2').click(function () {
     $('#customer_name_others_address').val('');
 });

</script>
<script type="text/javascript">

function product_stock(sl) {

            var  batch_id=$('#batch_id_'+sl).val();
            var dataString = 'batch_id='+ batch_id;
            var base_url    = $('.baseUrl').val();
            var available_quantity    = 'available_quantity_'+sl;
            var product_rate    = 'product_rate_'+sl;
            var expire_date    = 'expire_date_'+sl;
             $.ajax({
                type: "POST",
                url: base_url+"Cinvoice/retrieve_product_batchid",
                data: dataString,
                cache: false,
                success: function(data)
                {
                    obj = JSON.parse(data);

                    var today = new Date();
                    var dd = today.getDate();
                    var mm = today.getMonth()+1; //January is 0!
                    var yyyy = today.getFullYear();

                    if(dd<10){
                        dd='0'+dd;
                    }
                    if(mm<10){
                        mm='0'+mm;
                    }
                    var today = yyyy+'-'+mm+'-'+dd;

                    aj = new Date(today);
                    exp = new Date(obj.expire_date);

                    // alert(today);

                    if (aj >= exp) {

                     alert('');
                      $('#batch_id_'+sl)[0].selectedIndex = 0;


                      $('#'+expire_date).html('<p style="color:red;align:center">'+obj.expire_date+'</p>');
                       document.getElementById('expire_date_'+sl).innerHTML = '';


                    }else{
                       $('#'+expire_date).html('<p style="color:green;align:center">'+obj.expire_date+'</p>');
                    }
                    $('#'+available_quantity).val(obj.total_product);

                }
             });

            $(this).unbind("change");
            return false;



}


  function checkqty(sl)
{

  var quant=$("#total_qntt_"+sl).val();
  var price=$("#price_item_"+sl).val();
  var dis=$("#discount_"+sl).val();
  if (isNaN(quant))
  {
    alert("Must input numbers");
    document.getElementById("total_qntt_"+sl).value = '';
     //$("#quantity_"+sl).val() = '';
    return false;
  }
  if (isNaN(price))
  {
    alert("Must input numbers");
     document.getElementById("price_item_"+sl).value = '';
    return false;
  }
  if (isNaN(dis))
  {
    alert("Must input numbers");
     document.getElementById("discount_"+sl).value = '';
    return false;
  }
}
//discount and paid check
function checknum(){
      var dis=$("#invdcount").val();
      var paid=$("#paidAmount").val();
      if (isNaN(dis))
  {
    alert("Must input numbers");
     document.getElementById("invdcount").value = '';
    return false;
  }
  if (isNaN(paid))
  {
    alert("Must input numbers");
     document.getElementById("paidAmount").value = '';
    return false;
  }
    }
</script>


            <footer class="main-footer">
    <strong>
    	CopyrightÃ‚Â© 2017-2018 bdtask. All rights reserved.   	</strong><i class="fa fa-heart color-green"></i>
</footer>        </div>
        <!-- ./wrapper -->

        <!-- Start Core Plugins-->
        <!-- jquery-ui -->
         <!-- Select2 min js -->
        <script src="Add%20New%20Invoice_files/select2.js" type="text/javascript"></script>
        <script src="Add%20New%20Invoice_files/jquery-ui.js" type="text/javascript"></script>
        <!-- Bootstrap -->
        <script src="Add%20New%20Invoice_files/bootstrap.js" type="text/javascript"></script>
        <!-- SlimScroll -->
        <script src="Add%20New%20Invoice_files/jquery.js" type="text/javascript"></script>
        <!-- FastClick -->
        <script src="Add%20New%20Invoice_files/fastclick.js" type="text/javascript"></script>
        <!-- AdminBD frame -->
        <script src="Add%20New%20Invoice_files/frame.js" type="text/javascript"></script>
        <!-- Sparkline js -->
        <script src="Add%20New%20Invoice_files/sparkline.js" type="text/javascript"></script>
        <!-- Counter js -->
        <script src="Add%20New%20Invoice_files/waypoints.js" type="text/javascript"></script>
        <script src="Add%20New%20Invoice_files/jquery_002.js" type="text/javascript"></script>
        <!-- DataTables js -->
        <script src="Add%20New%20Invoice_files/dataTables.js" type="text/javascript"></script>
        <!-- Dashboard js -->
        <script src="Add%20New%20Invoice_files/dashboard.js" type="text/javascript"></script>

        <!-- Modal js -->
        <script src="Add%20New%20Invoice_files/classie.js" type="text/javascript"></script>
        <script src="Add%20New%20Invoice_files/modalEffects.js" type="text/javascript"></script>


        <script type="text/javascript">
        $(document).ready(function(){
            $(".datepicker").datepicker();
            //Datatable
            $("#dataTableExample3").DataTable( {
                dom:"<'row'<'col-sm-4'l><'col-sm-4 text-center'B><'col-sm-4'f>>tp", lengthMenu:[[10, 25, 50, -1], [10, 25, 50, "All"]], buttons:[ {
                    extend: "copy", className: "btn-sm"
                }
                , {
                    extend: "csv", title: "ExampleFile", className: "btn-sm"
                }
                , {
                    extend: "excel", title: "ExampleFile", className: "btn-sm"
                }
                , {
                    extend: "pdf", title: "ExampleFile", className: "btn-sm"
                }
                , {
                    extend: "print", className: "btn-sm"
                }
                ]
            });
             // select 2 dropdown
            $("select.form-control:not(.dont-select-me)").select2({
                placeholder: "Select option",
                allowClear: true
            });
        });


        </script>

<ul id="ui-id-1" tabindex="0" class="ui-menu ui-widget ui-widget-content ui-autocomplete ui-front" style="display: none;"></ul><div role="status" aria-live="assertive" aria-relevant="additions" class="ui-helper-hidden-accessible"></div><div id="toTop" class="btn back-top" style="display: block;"><span class="ti-arrow-up"></span></div><div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div></body>


{% endblock %}

